# Генератор учебных заданий

Streamlit приложение для автоматической генерации учебных заданий на основе компетенций и индикаторов с использованием Claude API.

## Описание

Приложение автоматически генерирует учебные задания различных типов:
- Задания закрытого типа на установление соответствия
- Задания закрытого типа на установление последовательности
- Задания комбинированного типа с выбором одного правильного ответа
- Задания комбинированного типа с выбором нескольких правильных ответов
- Задания открытого типа с развернутым ответом

## Требования

- Python 3.8+
- API ключ от Anthropic (Claude)

## Установка

1. Клонируйте репозиторий или скачайте файлы

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Запуск

```bash
streamlit run app.py
```

Приложение откроется в браузере по адресу `http://localhost:8501`

## Использование

### Шаг 1: Подготовка файлов

Вам понадобятся два файла:

1. **Файл с данными** (Excel `.xlsx` или Word `.docx`)

   **Для Excel файла** (например, `megaphops.xlsx`):
   - Столбец A: Код и наименование компетенции
   - Столбец B: Индикатор достижения компетенции
   - Столбец C: Дисциплина / модуль / практика
   - Столбец D: Уровень сложности (тип задания)
   - Столбец E: Задание (будет заполнено автоматически)
   - Столбец F: Ключ (ответ) (будет заполнено автоматически)

   **Для Word файла** (`.docx`):
   - Должен содержать таблицу с теми же столбцами
   - Первая строка таблицы - заголовки
   - Приложение автоматически извлечет первую таблицу из документа

2. **Файл с промптами** (текстовый `.txt` или Word `.docx`)

   **Для текстового файла** (например, `promt`):
   - Содержит инструкции для генерации каждого типа задания
   - Формат: тип задания + TAB + инструкция

   **Для Word файла** (`.docx`):
   - Может содержать текст в параграфах или в таблицах
   - Приложение автоматически извлечет весь текст

### Шаг 2: Настройка приложения

1. Введите ваш Claude API ключ в боковой панели
2. Загрузите файл с данными (Excel или Word)
3. Загрузите файл с промптами (TXT или Word)

### Шаг 3: Генерация заданий

1. Укажите диапазон строк для обработки (начальная и конечная строка)
2. Нажмите кнопку "Сгенерировать задания"
3. Дождитесь завершения генерации
4. Просмотрите результаты

### Шаг 4: Экспорт результатов

1. После генерации нажмите кнопку "Скачать результат (Excel)"
2. Сохраните файл с заполненными заданиями и ключами

## Структура файлов

```
.
├── app.py                 # Основное приложение Streamlit
├── requirements.txt       # Зависимости Python
├── README.md             # Инструкция (этот файл)
├── megaphops.xlsx        # Пример Excel файла с данными
└── promt                 # Файл с промптами для генерации
```

## Особенности

- Поддержка нескольких форматов файлов:
  - Excel (.xlsx, .xls) для данных
  - Word (.docx) для данных с таблицами
  - Текстовые файлы (.txt) для промптов
  - Word (.docx) для промптов
- Автоматическое определение формата файла и способа чтения
- Автоматическое определение типа задания из столбца D
- Генерация заданий с учетом компетенций и индикаторов
- Прогресс бар для отслеживания процесса генерации
- Предпросмотр данных перед обработкой
- Экспорт результатов в Excel
- Обработка ошибок и пропуск строк с некорректными данными

## Лимиты API

Приложение использует Claude API. Учитывайте следующее:
- Между запросами есть задержка 0.5 секунды для соблюдения rate limits
- Для больших объемов данных рекомендуется обрабатывать по частям (10-50 строк за раз)
- Стоимость генерации зависит от вашего тарифного плана Anthropic

## Получение API ключа

1. Зарегистрируйтесь на [https://console.anthropic.com/](https://console.anthropic.com/)
2. Перейдите в раздел API Keys
3. Создайте новый API ключ
4. Скопируйте ключ и используйте в приложении

## Решение проблем

### Ошибка "ModuleNotFoundError"
Убедитесь, что установили все зависимости:
```bash
pip install -r requirements.txt
```

### Ошибка API
Проверьте правильность API ключа и наличие средств на аккаунте Anthropic

### Некорректная генерация
Убедитесь, что файл `promt` содержит инструкции для всех типов заданий из столбца D

### Ошибка при чтении Word файла
- Для файла с данными: убедитесь, что документ содержит таблицу
- Для файла с промптами: проверьте, что текст правильно отформатирован
- Таблица в Word должна быть в том же формате, что и Excel файл

## Автор

Создано для автоматизации генерации учебных заданий
